<!DOCTYPE html>
<html lang="ru">
 <head>
  <meta charset="utf-8">
  <title>ICO Zimma Coin</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script type="text/javascript" src="web3.js"></script>
  <style>
  p {
    color:  navy;
  }

  .heading {
    color: navy;
    font-size: 64;
  }
  </style>
 </head>

 <body>
   <p>
    <div class="heading" align="center">
      <B> Вы можете купить Zimma Coin </b>
    </div>

      </div>
      <div class="heading" align="center">
        <P>
          <input type="text" placeholder="Введите сумму эфиров..." id="inputEthers">
      </div>

      <div align="center">
      <div class="sendButton" align="center" style="cursor: pointer; background-color: navy; width: 100px; height: 20px" >
        <font color="White"> Отправить! </font>
      </div></div>
      <script>

          $(".sendButton").click(function(){

              let Web3 = require('web3');
              if (typeof web3 !== 'undefined'){
                  web3 = new Web3(web3.currentProvider);
              }
              else {
                  alert('You have to install MetaMask !');
              }

              const abi = [{"constant": true,"inputs": [],"name": "startTime","outputs": [{"name": "","type": "uint256"}],"payable": false,"stateMutability": "view","type": "function"},{"constant": true,"inputs": [],"name": "buyPrice","outputs": [{"name": "","type": "uint256"}],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "buy",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": true,
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "token",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"name": "_token",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"payable": true,
		"stateMutability": "payable",
		"type": "fallback"
	}
];
              const contractAddress = "0x20481522aa75986E57C490B1f19B968f62f94148";
              let MyContract = web3.eth.contract(abi);
              let myContractInstance = MyContract.at(contractAddress);

              web3.eth.sendTransaction({
                      to: contractAddress,
                      from: web3.eth.accounts[0],
                      value: web3.toWei($('#inputEthers').val(), "ether")
                  },
                  function(error){
                      console.log(error);
                  }
              );
          });

          $(".sendFunctionButton").click(function(){

              let Web3 = require('web3');
              if (typeof web3 !== 'undefined'){
                  web3 = new Web3(web3.currentProvider);
              }
              else {
                  alert('You have to install MetaMask !');
              }

              const abi = [
	{
		"constant": true,
		"inputs": [],
		"name": "startTime",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "buyPrice",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "buy",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": true,
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "token",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"name": "_token",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"payable": true,
		"stateMutability": "payable",
		"type": "fallback"
	}
];
              const contractAddress = "0x20481522aa75986E57C490B1f19B968f62f94148";
              let MyContract = web3.eth.contract(abi);
              let myContractInstance = MyContract.at(contractAddress);
              let functionData = myContractInstance.buy.getData();
              web3.eth.sendTransaction({
                      to:contractAddress,
                      from:web3.eth.accounts[0],
                      data: functionData,
                      value: web3.toWei($('#inputEthers').val(), "ether")
                  },
                  function(error){
                      console.log(error);
                  });
          });

      </script>
 </body>
</html>
